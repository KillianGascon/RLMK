generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Aliment {
  id                  Int       @id @default(autoincrement())
  Nom_Aliment         String    @db.VarChar(100)
  Description_Aliment String?   @db.Text
  Date_Peremption     DateTime? @db.Date
  Type_Aliment        String?   @db.VarChar(50)
  Quantite            Float?    @db.Float
  Unite_Quantite      String?   @db.VarChar(50)
  Id_Stock            Int
  Stock               Stock     @relation(fields: [Id_Stock], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "Aliment_ibfk_1")

  @@index([Id_Stock], map: "Id_Stock")
}

model Donnees {
  id            Int      @id @default(autoincrement())
  Timestamp     DateTime @db.DateTime(0)
  Type_Donnee   String   @db.VarChar(50)
  Unite_Donnee  String?  @db.VarChar(50)
  Valeur_Donnee Float    @db.Float
  Id_ESP32      Int
  ESP32         ESP32    @relation(fields: [Id_ESP32], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "Donnees_ibfk_1")

  @@index([Id_ESP32], map: "Id_ESP32")
}

model ESP32 {
  id               Int       @id @default(autoincrement())
  AdresseMac_ESP32 String    @db.VarChar(50)
  Id_Plante        Int
  Donnees          Donnees[]
  Plante           Plante    @relation(fields: [Id_Plante], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "ESP32_ibfk_1")

  @@index([Id_Plante], map: "Id_Plante")
}

model Foyer {
  id                Int                 @id @default(autoincrement())
  Nom_Foyer         String              @db.VarChar(100)
  Plante            Plante[]
  Stock             Stock[]
  Utilisateur_Foyer Utilisateur_Foyer[]
  pieces  Piece[]
}

model Piece {
  id                Int      @id @default(autoincrement())
  Nom_Piece         String
  Description_Piece String?
  Surface_m2        Decimal? @db.Decimal(6, 2)
  Type_Piece        String
  Id_Foyer          Int

  stocks Stock[]
  foyer             Foyer    @relation(fields: [Id_Foyer], references: [id])
}

model Plante {
  id                   Int       @id @default(autoincrement())
  Nom_Plante           String    @db.VarChar(100)
  Espece               String    @db.VarChar(100)
  Emplacement          String    @db.VarChar(100)
  Frequence_Arrosage   String    @db.VarChar(50)
  Besoin_Lumiere       String    @db.VarChar(50)
  Humidite_Optimale    Decimal?  @db.Decimal(5, 2)
  Temperature_Optimale Decimal?  @db.Decimal(5, 2)
  Note                 String?   @db.Text
  Description_Plante   String?   @db.Text
  Date_Plantation      DateTime? @db.Date
  Id_Foyer             Int


  // Relations
  Foyer Foyer  @relation(fields: [Id_Foyer], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "Plante_ibfk_1")
  ESP32 ESP32[]

  @@index([Id_Foyer], map: "Id_Foyer")
}


model Stock {
  id                Int       @id @default(autoincrement())
  Nom_Stock         String    @db.VarChar(100)
  Description_Stock String?   @db.Text
  Type_Stock        String    @db.VarChar(50)
  Id_Foyer          Int
  Id_Piece          Int

  // Relations
  Aliment   Aliment[]
  Foyer     Foyer @relation(fields: [Id_Foyer], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "Stock_ibfk_1")
  Piece     Piece @relation(fields: [Id_Piece], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "Stock_ibfk_2")

  @@index([Id_Foyer], map: "Id_Foyer")
  @@index([Id_Piece], map: "Id_Piece")
}


model Utilisateur {
  id                      Int                 @id @default(autoincrement())
  Nom_Utilisateur         String              @db.VarChar(100)
  Prenom_Utilisateur      String              @db.VarChar(100)
  Identifiant_Utilisateur String              @unique(map: "Identifiant_Utilisateur") @db.VarChar(50)
  MotDePasse_Utilisateur  String              @db.VarChar(255)
  Email_Utilisateur       String              @unique(map: "Email_Utilisateur") @db.VarChar(100)
  Telephone_Utilisateur   String?             @db.VarChar(20)
  Utilisateur_Foyer       Utilisateur_Foyer[]
}

model Utilisateur_Foyer {
  id             Int         @id @default(autoincrement())
  Id_Utilisateur Int
  Id_Foyer       Int
  Role           String?     @db.VarChar(50)

  Utilisateur    Utilisateur @relation(fields: [Id_Utilisateur], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "Utilisateur_Foyer_ibfk_1")
  Foyer          Foyer       @relation(fields: [Id_Foyer], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "Utilisateur_Foyer_ibfk_2")

  @@index([Id_Foyer], map: "Id_Foyer")
  @@index([Id_Utilisateur], map: "Id_Utilisateur")
}
